# ppt文案

[TOC]

## 时钟树

1. 时钟源,产生时钟
2. 数选器,配置寄存器选择需要的时钟源
3. 锁相环,倍频已有时钟
4. CSS时钟安全系统,对外部高速时钟进行监测,外部高速时钟
出现故障会直接切换回内部高速时钟,并触发中断
5. 分频器,也是寄存器可配置对已有时钟进行分频获取需要的时钟
6. 门控时钟,在不同电源模式下可关断时钟,减低功耗
7. MCO内部时钟输出,引出可检测时钟信号

## 电源

==datasheet的电源方案有断路==
注意:模拟域的参考电压小于电源电压,且参考电压代表的是ADC的满量程,且需要稳定

## 系统框图

没啥好说的,==唯一不确定的点是AHB_lite是AHB2AHB还是AHB的一个mux==

## cortex-M3

>Icode和Dcode和System这样设计的目的是什么?

1. I和D与S访问地址不同,可以同时传输,可以做到哈佛结构的优势;==但如果I和S同时取指令或者取向量时会怎么样?==
2. I和D访问地址相同,不可同时传输,目的我觉得可能是考虑到了AHB的流水线结构;指令和文字池常量的地址可能比较比较大,如果在一个总线上的话,AHB主机就需要反复装填地址,会很麻烦;同时ARM建议Dcoed的优先级要高于指令,可能是为了防止数据相关性问题

>三种总线接口访问的场景都是什么

1. Icode:
   1. 指令寄存器取指令(注意只能读)
   2. PC寄存器取地址(注意只能读)
2. Dcode:
   1. 访存指令
   2. 调试命令
3. System:
   1. 访存指令
   2. 指令寄存器取指令
   3. PC寄存器取地址
   4. 调试命令

## DMA

1. IO数据传输方式 [了解更多点这里](https://www.jianshu.com/p/d1542085afde)
   1. 循环IO测试(CPU完全介入,无需额外硬件)
   CPU通过轮询检测IO的空/闲标志,去缓慢驱动外设
   2. 程序中断IO方式(CPU部分介入,增加中断控制)
   CPU写入/读取外设控制缓冲区,缓冲区空/满触发中断让CPU响应;
   缓冲区基本上不会太大,可能是给几级FIFO;
   反复中断对于处理器的代价也不小(拉满12个周期);
   当IO设备很多时,CPU可能只能处理中断
   3. DMA方式(CPU部分介入,增加中断控制,增加DMA)
    在内存和IO设备之间直接进行数据交换，不需要CPU的干预。当需要IO数据传输时，CPU将DMA初始化，之后DMA接管总线的使用权，将所需要的数据全部读入内存后，IO设备的控制器才会发出中断;
    这样可以有效降低中断次数,输出很多字符时有可观的性能;
    但值得注意DMA往往比CPU慢的多,如果DMA工作时CPU没啥事情做,那么说不定上两种方式会更好;
   4. 通道方式
   针对IO设备众多,输入输出频繁的,以上三种方式还是太慢其本质是针对不同外设类型的协处理器,dma只能配置参数
    ,而通道可以根据CPU的指令去初始化设备,搬运数据,收尾设备.
2. DMA构成
   1. 以一个通道为例子,mux将来自不同的外设请求送入DMA,外设也可以通过寄存器使能来控制是否发送请求
   2. 注意DMA会占据系统总线,为了总体性能,总线仲裁器会进行调度,可能是run-round型的冲裁方式
   3. 